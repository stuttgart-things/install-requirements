---
- name: make sure pip is installed
  package:
    name: "{{ python_pip_name }}"
    state: present
  when:
    - (ansible_distribution == 'CentOS' or ansible_distribution == 'RedHat') and (ansible_distribution_major_version == '8') or (ansible_distribution == 'Ubuntu')
  tags: install

# CentOS7 and RHEL 7 fix
- name: legacy - make sure pip is installed
  shell: "yum -y install {{ python_pip_name }}"
  when:
    - (ansible_distribution == 'CentOS' or ansible_distribution == 'RedHat') and (ansible_distribution_major_version == '7')
  tags: install

- name: install python modules
  pip:
    name: "{{ item.name }}"
    version: "{{ item.version | default(omit) }}"
    executable: /usr/bin/pip{{ python_version }}
    state: "{{ state }}"
  loop: "{{ python_modules }}"
  tags: install
  when: python_modules is defined

